---
title: "Rainbeamã§è‡ªå‰ã®è³ªå•ç®±ã‚’å»ºã¦ã‚‹"
date: 2024-10-27
description: "Retrospringã®å¾Œç¶™ã§ã‚ã‚‹Rainbeamã‚’ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã™ã‚‹"
tags: ["tech", "web", "rust", "selfhost"]
emoji: "ğŸŒˆ"
---

ã”ãã’ã‚“ã‚ˆã†ã€‚å„ä½é¦´ã‚Œåˆã£ã¦ã„ã‚‹ã‹ï¼Ÿã€€ã“ã¡ã‚‰ã‚‚é¦´ã‚Œåˆã£ã¦ã„ã‚‹ã€‚ä¸»ã«è³ªå•ç®±ã§ã€‚

ã‚ã‚‹ç¨®ã®å‹‡æ•¢ã•ã‚’ã‚‚ã£ãŸäººã€…ã«ã¨ã£ã¦ã€è³ªå•ç®±ã€ã™ãªã‚ã¡åŒ¿åã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯å¼±æ°—ã®åŒç¾©èªã«ã™ããªã„ã€‚ã¾ãŸåˆ¥ã®æ…æ…®ã‚ã‚‹äººã€…ã«ã¨ã£ã¦ã¯ã€ãã‚Œã‚‰ã¯å”¾æ£„ã™ã¹ãé¦´ã‚Œåˆã„ã®é“å…·ã ã€‚å½¼ã‚‰ã®è¨€ã„åˆ†ã‚’ç·åˆã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ï¼š\{é¡•åã§ã—ã‚ƒã¹ã‚‹ã‹|ã‚ªãƒ¼ãƒ«}ã€\{ã‚ã‚‹ã„ã¯|ã‚ªã‚¢}ã€\{ä½•ã‚‚ã—ãªã„ã‹|ãƒŠãƒƒã‚·ãƒ³ã‚°}ã€‚ä¸¡è€…ã®ã‚ã„ã ã«é“ã¯ãªã„ã€‚ã¡ã‚‡ã†ã©å¤©ã¨åœ°ã®ã‚ã„ã ã«å®‰ä½ã®åœ°ãŒãªã„ã®ã¨åŒã˜ã‚ˆã†ã«ã€‚

ã—ã‹ã—ï¼ˆã“ã“ã§ç›®ã‚’ç‘ã‚‹ï¼‰ã€\{ç§|ãã¿ãŸã¡}ãŒã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã©ã†ã¿ãªã™ã‹ã¨ã„ã†å•é¡Œã¨åˆ¥ã«ã€\{ç§|ãã¿ãŸã¡}ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¨ã‚‹ç›¸æ‰‹ãŒã©ã†ã„ã†è¦–ç‚¹ã‚’ã¨ã‚‹ã‹ã¨ã„ã†å•é¡Œã‚‚ã¾ãŸã‚ã‚‹ï¼ˆé©šãã¹ãã“ã¨ã«ï¼‰ã€‚äº‹å®Ÿã€\{ç§|ãã¿ãŸã¡}ã®ã‚ˆã†ãªæ„›æƒ³ã®æ‚ªã„äººé–“ã‚’ç›¸æ‰‹ã™ã‚‹ã«ã‚ãŸã£ã¦ã¯ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­é–“çš„ãªãƒ¢ãƒ¼ãƒ‰ãŒå½¹ç«‹ã¤ã“ã¨ã‚‚ã‚ã‚‹ã‚‰ã—ã„ã€‚ãã®ã“ã¨ã«æ°—ã¥ã„ãŸã®ã¯å¾Œã«ãªã£ã¦ã‹ã‚‰ã ãŒã€ã¨ã‚‚ã‹ãã‚‚ã€ä½•ã‚’éš ãã†ã€ç§ã¯ã—ã°ã‚‰ãå‰ã‹ã‚‰è³ªå•ç®±ã‚’é–‹ã„ã¦ã„ãŸã€‚ãã—ã¦**è‰¯ã„å¸°çµ**ã‚’å¾—ãŸã€‚è³­ã‘ã«å‹ã£ãŸã®ã ã€‚

ã•ã¦ã€ãªãœä»Šã«ãªã£ã¦ã“ã‚“ãªè©±ã‚’å§‹ã‚ãŸã‹ã¨ã„ãˆã°ã€ä½¿ã£ã¦ã„ãŸè³ªå•ç®±â€•â€•[Retrospring](https://github.com/Retrospring/retrospring)â€•â€•ã®é–‹ç™ºãŒçµ‚ã‚ã‚Šã€å…¬å¼ã‚µãƒ¼ãƒï¼ˆ`retrospring.net`ï¼‰ã‚‚è¿‘ãé–‰é–ã•ã‚Œã‚‹ã“ã¨ãŒæ±ºã¾ã£ãŸã‹ã‚‰ã ï¼ˆ[å‡ºå…¸](https://blog.retrospring.net/retrospring-is-shutting-down-on-1st-march-2025)ï¼‰ã€‚è³ªå•ç®±ã‚µãƒ¼ãƒ“ã‚¹ã¯æ•°å¤šã‚ã‚‹ãŒã€Retrospringã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†ç‚¹ã§ï¼ˆä»¥å‰ã¯ï¼‰å”¯ä¸€ç„¡äºŒã ã£ãŸã€‚ã‚·ãƒ³ãƒ—ãƒ«ãªãŒã‚‰æœ€ä½é™ã®æ©Ÿèƒ½ã‚’ã‚‚ã¡ã€æ€ªã—ã’ãªåºƒå‘Šã‚„å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€£æºã‚‚ãªãã€ä¾¿åˆ©ã¨ã¯ã„ãˆãªã„ã¾ã§ã‚‚ã€ã‚ã‚‹ç¨‹åº¦\{ã¾ã¨ã‚‚|ãƒ‡ã‚£ãƒ¼ã‚¹ãƒ³ãƒˆ}ã§ã¯ã‚ã£ãŸã€‚ã ãŒãã‚Œã‚‚ã‚‚ã†çµ‚ã‚ã‚Šã ã€‚çµ‚äº†ã®ç†ç”±ã¨ã—ã¦ç¤ºã•ã‚ŒãŸæ–‡è¨€ã«ã¯ã€ã©ã“ã‹å“€æ„ã‚’èª˜ã†ã‚ˆã†ãªèª¿å­ãŒã‚ã‚‹ã€‚

> Retrospring never was a large company, as many might have assumed. It never was a company at all. Retrospring started as a project by two friends, later having another one join, and someone leaving again. So, currently, the entire site is being taken care of by 2 people.
>
> With service quality steadily degrading and us not being able to keep up anymore, which is turning into more and more of a liability with our current user counts, we are deciding to shut down the service.

ã‹ãã—ã¦ã¾ãŸã²ã¨ã¤å¢“ç¢‘ãŒå¢—ãˆã€ã‚ã‚Œã‚ã‚Œã¯è·¯é ­ã«è¿·ã†ã€‚ãã—ã¦[ãƒª](https://marshmallow-qa.com)[ãƒ´ã‚¡](https://peing.net/ja/)[ã‚¤](https://querie.me/)[ã‚¢](https://boxfresh.site)[ã‚µãƒ³](https://zabuu.site)ã®é¤Œé£Ÿã«â€¦â€¦

ãªã‚‰ãšã«æ¸ˆã¿ãã†ã ã€‚å¹¸ã„ã«ã‚‚ã€ã»ã¼å¾Œç¶™ã¨ã„ã£ã¦ã„ã„[^1]ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®é–‹ç™ºãŒå§‹ã¾ã£ã¦ã„ãŸã€‚

[https://github.com/swmff/rainbeam](https://github.com/swmff/rainbeam)

Rainbeamã¨ã„ã„ã€Rustè£½ã€ã‚·ãƒ³ãƒ—ãƒ«å¿—å‘ã€ã¨ã„ã‹ã«ã‚‚ãŠãŸãå¥½ã¿ã®å‘³ä»˜ã‘ã ã€‚ä½¿ã„å‹æ‰‹ã¯[å…¬å¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹](https://neospring.org)ã«ç™»éŒ²ã—ã¦ç¢ºèªã§ãã‚‹ã€‚

[^1]: Rainbeam is a faithful recreation of the amazing Q\&A site Retrospring. Rainbeam uses many Retrospring's core concepts, ideas, and designs, however it is built from the ground up and uses none of Retrospring's original code or assets. ï¼ˆREADMEã‚ˆã‚Šï¼‰

é§†ã‘å‡ºã—ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚‰ã—ãã€ã¾ã å°å…¥æ‰‹é †ç­‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ•´ã£ã¦ã„ãªã„ã€‚ã—ã‹ã—æ“ä½œæ„Ÿãƒ»UIãŒå¥½ã¿ãªã®ã§ã€ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆã§ãã‚‹ã‹è©¦ã—ã¦ã¿ãŸã€‚

## è¦ä»¶

### å‹•ä½œã«å¿…è¦ãªã‚‚ã®

- RAMãŒ1GBç¨‹åº¦ã®Linuxã‚µãƒ¼ãƒ
- Redis
- SQLite3
- ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ï¼ˆCaddyã‚„Nginxï¼‰
- [hCaptcha](https://www.hcaptcha.com)ã®ã‚µã‚¤ãƒˆã‚­ãƒ¼ãƒ»ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ

1GBã¨æ›¸ã„ãŸãŒã€å®Ÿéš›ã®ãƒ¡ãƒ¢ãƒªæ¶ˆè²»ã¯ã‚‚ã£ã¨å°‘ãªã„ã†ãˆã€å¸¸ã«è² è·ãŒã‹ã‹ã‚‹ã‚ˆã†ãªä»£ç‰©ã§ã‚‚ãªã„ã®ã§ã€ã‚ˆã‚Šã•ã•ã‚„ã‹ãªç’°å¢ƒã§ã‚‚å‹•ãã‹ã‚‚ã—ã‚Œãªã„ã€‚ä»Šå›ã¯[OCI Cloud Free Tier](https://www.oracle.com/jp/cloud/free/)ã§å»ºã¦ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆ`VM.Standard.E2.1.Micro`, Ubuntu 24.04 minimalï¼‰ã‚’ä½¿ã†ã€‚

### ãƒ“ãƒ«ãƒ‰ã«å¿…è¦ãªã‚‚ã®

- Linuxç’°å¢ƒï¼ˆãŠãã‚‰ã[^2]ï¼‰
- `build-essentials`ãªã„ã—ãã‚Œã«é¡ã™ã‚‹ãƒ„ãƒ¼ãƒ«ç¾¤ï¼ˆ`gcc`ãªã©ï¼‰
- Rustã®ãƒ“ãƒ«ãƒ‰ç’°å¢ƒ
- [`just`](https://just.systems)ï¼ˆã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ï¼‰
- `pkg-config`
- `libssl-dev`

[^2]: ã¨ã„ã†ã®ã‚‚ã€ä»–ã®OSã§ã®ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã‹ã¯ä¸æ˜ãªã®ã§ï¼ˆè©¦ã—ã¦ã„ãªã„ãŒã€OpenSSLã«ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹é–¢ä¿‚ã§ãŸã¶ã‚“ã†ã¾ãã„ã‹ãªã„ï¼‰ã€‚

ãƒ“ãƒ«ãƒ‰ã¯ãã‚Œãªã‚Šã«é‡ã„ã€‚å‹•ä½œã•ã›ã‚‹ã‚µãƒ¼ãƒä¸Šã§ç›´æ¥ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚‚ã‚ˆã„ãŒã€ã‚µãƒ¼ãƒã®ã‚¹ãƒšãƒƒã‚¯ã«ã‚ˆã£ã¦ã¯ã‚ã‚Šãˆãªã„æ™‚é–“ãŒã‹ã‹ã‚Š[^3]ã€å¾…ã¡æ™‚é–“ã«ä¹åå„„ã®ç¥ã®å¾¡åã‚’æ•°ãˆçµ‚ã‚ã£ã¦ã—ã¾ã†ã®ã§ã€åˆ¥ã®ãƒã‚·ãƒ³ã§è¡Œã†ã®ãŒç„¡é›£ã ã‚ã†ã€‚æ—¥å¸¸çš„ã«Linuxã‚’ä½¿ã£ã¦ã„ãªã„ã‹ã‚ã„ãã†ãªãƒ¦ãƒ¼ã‚¶ã®å ´åˆã€Dockerã‚„GitHub Actionsãªã©ã§é©å½“ãªãƒ“ãƒ«ãƒ‰ç’°å¢ƒã‚’ã§ã£ã¡ä¸Šã’ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

[^3]: ãã®ã†ãˆãƒ¡ãƒ¢ãƒªæ¶ˆè²»ã‚‚æ¿€ã—ã„ï¼ˆå‚è€ƒã¾ã§ã«ï¼šRAM 1GB + ã‚¹ãƒ¯ãƒƒãƒ—é ˜åŸŸ4GBã®ç’°å¢ƒã§ã€ã‚¹ãƒ¯ãƒƒãƒ—1\~2GBã‚’æ¶ˆè²»ï¼‰

## ãƒ“ãƒ«ãƒ‰

### ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```sh
# Ubuntu 24.04 ã®å ´åˆ
sudo apt install build-essentials rustup just pkg-config libssl-dev
```

### å®Ÿè¡Œ

ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã€`just build`ã§ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚å¼•æ•°ã«ã¯åˆ©ç”¨ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã€‚å°è¦æ¨¡ãƒ»å€‹äººç”¨ã®å ´åˆã¯SQLiteã§ååˆ†ã ã‚ã†ï¼ˆPostgreSQLã‚„MySQL / MariaDBã‚‚é¸ã¹ã‚‹ã‚‰ã—ã„ï¼‰ã€‚

```sh
git clone https://github.com/swmff/rainbeam
cd rainbeam
just build sqlite
```

çµ‚ã‚ã£ãŸã‚‰`./target/release/rainbeam`ã«ã‚ã‚‹ãƒã‚¤ãƒŠãƒªã‚’ã‚µãƒ¼ãƒä¸Šã«è»¢é€ã—ã¦ãŠãã€‚

## ã‚µãƒ¼ãƒã®è¨­å®š

ä»¥ä¸‹ã€ã‚µãƒ¼ãƒã®IPã¨ç´ã¥ã„ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ`ask.example.com`ã¨ã™ã‚‹ï¼‰ã®è¨­å®šã¯æ¸ˆã‚“ã§ã„ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚Cloudflareãªã‚Šãªã‚“ãªã‚Šã®CDNã‚’æŒŸã‚€å ´åˆã‚‚ã‚ã‚‰ã‹ã˜ã‚è¨­å®šã‚’æ¸ˆã¾ã›ã¦ãŠãã€‚

### ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»æœ‰åŠ¹åŒ–

```sh
# Ubuntu 24.04 ã®å ´åˆ
sudo apt install redis sqlite3 caddy
sudo systemctl enable redis-server --now
sudo systemctl enable caddy --now
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†

ã‚µãƒ¼ãƒä¸Šã«ã‚‚Rainbeamã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãŠãã€‚ã“ã®ä½œæ¥­ã¯å³å¯†ã«ã¯å¿…è¦ãªã„ãŒã€ãƒªãƒã‚¸ãƒˆãƒªã®`./.config/`ä»¥ä¸‹ã«å‚™ã‚ã£ã¦ã„ã‚‹è¨­å®šä¾‹ãƒ»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç”»åƒç­‰ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«è¡Œã£ã¦ã„ã‚‹ã€‚

ä»¥ä¸‹ã€ã™ã¹ã¦ã®ä½œæ¥­ã¯ã‚¯ãƒ­ãƒ¼ãƒ³ã—ãŸãƒªãƒã‚¸ãƒˆãƒªã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§è¡Œã†ã€‚

```sh
git clone https://github.com/swmff/rainbeam
cd rainbeam
```

ã¾ãš`./.config/config.toml`ã«è¨­å®šã‚’æ›¸ãã€‚`./.config/config.example.toml`ã«ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚‹ã»ã‹ã€[è¨­å®šã‚’èª­ã¿è¾¼ã‚€ã‚³ãƒ¼ãƒ‰](https://github.com/swmff/rainbeam/blob/master/crates/rainbeam-core/src/config.rs)ã«å„é …ç›®ã®èª¬æ˜ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ã®ã§å‚ç…§ã™ã‚‹ã¨ã‚ˆã„ã€‚å–å¾—ã—ã¦ãŠã„ãŸhCaptchaã®ã‚­ãƒ¼ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯ã“ã“ã«æ›¸ãè¾¼ã‚€ã€‚

```toml title="./.config/config.toml"
port = 8080 # RainbeamãŒå¾…ã¡å—ã‘ã‚‹ãƒãƒ¼ãƒˆ
name = "ãã¿ã®è³ªå•ç®±"
description = "ğŸŒˆ"
static_dir = "" # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã® ./.config/static/
registration_enabled = true # ãƒ¦ãƒ¼ã‚¶ç™»éŒ²ã‚’è¨±å¯ã™ã‚‹ã‹å¦ã‹ï¼ˆå¾Œè¿°ï¼‰
host = "https://ask.example.com" # ãã¿ã®è¨­å®šã—ãŸãƒ‰ãƒ¡ã‚¤ãƒ³
blocked_hosts = []
migration = false
real_ip_header = "CF-Connecting-IP" # Cloudflareã®CDNã‚’æŒŸã‚€å ´åˆ

[captcha]
site_key = "hCaptchaã®ã‚µã‚¤ãƒˆã‚­ãƒ¼"
secret = "hCaptchaã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ"

[tiers]
double_limits = 1
stylish_card = 1
avatar_crown = 1
profile_badge = 1
pages = 1
```

ç¶šã„ã¦`./.config/static/site/about.md`ã‚’ç·¨é›†ã™ã‚‹ã€‚ã©ã“ã«ã‚‚æ˜è¨˜ã•ã‚Œã¦ã„ãªã„ãŒã€ã“ã‚ŒãŒ`/site/about`ã«è¡¨ç¤ºã•ã‚Œã‚‹èª¬æ˜æ–‡ã«ãªã‚‹ï¼ˆ[ä¾‹](https://ask.cune.moe/site/about)ï¼‰ã€‚

```md
## ã“ã®è³ªå•ç®±ã«ã¤ã„ã¦

- ãŠå‰ã‚‚**æœ¬å½“ã«ç¾ã—ã„**é­‚ã«ãªã‚ŠãŸã„ã‚“ã ã‚ï¼Ÿ
  - ãªã‚ŠãŸã‘ã‚Œã°[ãƒ—ãƒ­ãƒ•](https://www.haxibami.net/about)ã¿ã¦
```

### ã¡ã‚‡ã£ã¨ã—ãŸãƒãƒƒã‚¯

```sh
touch main.db
```

åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«SQLiteã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`main.db`ï¼‰ãŒã‚ã‚‰ã‹ã˜ã‚å­˜åœ¨ã—ãªã„ã¨èµ·å‹•æ™‚ã«ãƒ‘ãƒ‹ãƒƒã‚¯ã‚’èµ·ã“ã™ã€‚ç©ºãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ˆã„ã®ã§ä½œæˆã—ã¦ãŠãã€‚

### ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã®è¨­å®š

è‰¯ãæ…£ç¿’ã«å¾“ã„ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¨ã®ç•Œé¢ã«ã¯ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚’æŒŸã‚€ã“ã¨ã«ã™ã‚‹ã€‚Nginxã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯**çµ¶å¯¾ã«æ›¸ããŸããªã„**ã®ã§ã€**äººé–“ã®é¡”ã‚’ã—ãŸå”¯ä¸€ã®**Webã‚µãƒ¼ãƒã§ã‚ã‚‹Caddyã®ä¾‹ã®ã¿ã‚’ç¤ºã™ã€‚

```Caddyfile title="/etc/caddy/Caddyfile"
ask.example.com {
	# Caddyã®è‡ªå‹•SSLã‚’ä½¿ã‚ãšåˆ¥ã®è¨¼æ˜æ›¸ï¼ˆCloudflareã®è¨¼æ˜æ›¸ãªã©ï¼‰ã‚’ä½¿ã†å ´åˆã¯ãã‚Œã‚‚æŒ‡å®š
	# tls /etc/ssl/certs/cloudflare.pem /etc/ssl/private/cloudflare.key
	encode zstd gzip
	reverse_proxy localhost:8080
}
```

```sh
sudo systemctl restart caddy
```

### systemdã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã ãŒã€systemdã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†ã—ãŸã„ãªã‚‰ãƒ¦ãƒ‹ãƒƒãƒˆã‚’æ›¸ã„ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶åãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯é©å®œèª­ã¿æ›¿ãˆã‚‹ã“ã¨ã€‚

```systemd title="/etc/systemd/system/rainbeam.service"
[Unit]
Description=Rainbeam daemon
Requires=caddy.service
After=caddy.service network-online.target

[Service]
Type=simple
User=rainbeam
ExecStart=/usr/local/bin/rainbeam
WorkingDirectory=/home/rainbeam/rainbeam
TimeoutSec=60
StandardOutput=journal
StandardError=journal
SyslogIdentifier=rainbeam
Restart=always

[Install]
WantedBy=multi-user.target
```

å¤‰æ›´ã‚’åæ˜ ã—ã¦ãƒ¦ãƒ‹ãƒƒãƒˆã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã€‚çŠ¶æ…‹ã‚’ç¢ºèªã—ã€å•é¡Œãªã•ãã†ãªã‚‰ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰è¨­å®šæ¸ˆã¿ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã€‚

```sh
sudo systemctl daemon-reload
sudo systemctl enable --now rainbeam
```

```console
> systemctl status rainbeam
â— rainbeam.service - Rainbeam daemon
     Loaded: loaded (/etc/systemd/system/rainbeam.service; enabled; preset: enabled)
     Active: active (running) since Sat 2024-10-26 03:28:55 UTC; 13h ago
   Main PID: XXXX (rainbeam)
      Tasks: X (limit: XXXX)
     Memory: 16.6M (peak: 17.3M)
        CPU: 3.589s
     CGroup: /system.slice/rainbeam.service
             â””â”€XXXX /home/rainbeam/rainbeam/target/release/rainbeam

2024-10-26T03:28:55.678132Z  INFO ğŸŒˆ Starting server at: http://localhost:8080!
```

ã†ã¾ãã„ã‘ã°ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã ã€‚

![ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸](../../assets/image/ask-cune-moe-top.png)

## åˆæœŸè¨­å®š

ã“ã®æ™‚ç‚¹ã§ã¯ã€Œæ¥ã‚‹è€…ã¯æ‹’ã¾ãšã€çŠ¶æ…‹ã§ã€ã‚ã‚‰ã‚†ã‚‹ãƒ¦ãƒ¼ã‚¶ãŒç™»éŒ²ã§ãã¦ã—ã¾ã†ã€‚è‡ªåˆ†ã®ç™»éŒ²ãŒæ¸ˆã‚“ã ã‚‰ã€ã„ã£ãŸã‚“ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ­¢ã‚ã€[è¨­å®š](#è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†)ã®`registration_enabled`ã‚’`false`ã«å¤‰æ›´ã—ã¦å†èµ·å‹•ã™ã‚‹ã€‚

ã‚ã¨ã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç­‰ã‚’è¨­å®šã™ã‚Œã°å®Œæˆã ã€‚

## çµæœ

ãã†ã„ã†ã‚ã‘ã§[è³ªå•ç®±](https://ask.cune.moe)ãŒå»ºã£ãŸã€‚ã„ã¤ã§ã‚‚åŒ¿åã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãŠå¾…ã¡ã—ã¦ã„ã¾ã™ã€‚
